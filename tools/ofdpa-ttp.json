{
  "NDM_metadata": {
    "authority": "com.broadcom",
    "OF_protocol_version": "1.3.4",
    "type": "TTPv1.0",
    "name": "OF-DPA 2.02",
    "version": "1.2.2 (Revision 2)",
    "doc": [
      "OF-DPA 2.02 Specification",
      "Uses features beyond TTPv1.0.",
      "Variations for compatibility with OpenDaylight TTP Project."
    ]
  },
  "features": [
    {
      "feature": "EXT-232",
      "doc": [
        "Table Synchronization (ONF Extensions Pack 1)"
      ]
    },
    {
      "feature": "EXT-233",
      "doc": [
        "Output Port Metadata (ONF Extensions Pack 2)"
      ]
    },
    {
      "feature": "EXT-244",
      "doc": [
        "Packet Registers (ONF Extensions Pack 2), Introduces PACKET_REGS(N) field."
      ]
    },
    {
      "feature": "EXT-320",
      "doc": [
        "Copy Field (ONF Extensions Pack 2)"
      ]
    },
    {
      "feature": "EXT-262",
      "doc": [
        "All messages should be TLV for ease of extensibility",
        "Added port description properties",
        "Requires OpenFlow 1.4."
      ]
    },
    {
      "feature": "EXT-306",
      "doc": [
        "Egress Tables",
        "Defined in OpenFlow 1.5",
        "Can be used with 1.3.4 except for table features message extensions."
      ]
    },
    {
      "feature": "ALLOW_IN_PORT",
      "doc": [
        "Used in group entries to override default OpenFlow IN_PORT forwarding restrictions.",
        "See EXT-138"
      ]
    }
  ],
  "table_map": [
    {
      "name": "Ingress Port",
      "number": 0
    },
    {
      "name": "Port DSCP Trust",
      "number": 5
    },
    {
      "name": "Port PCP Trust",
      "number": 6
    },
    {
      "name": "Tunnel DSCP Trust",
      "number": 7
    },
    {
      "name": "Tunnel PCP Trust",
      "number": 8
    },
    {
      "name": "Injected OAM",
      "number": 9
    },
    {
      "name": "VLAN",
      "number": 10
    },
    {
      "name": "VLAN 1",
      "number": 11
    },
    {
      "name": "Ingress Maintenance Point",
      "number": 12
    },
    {
      "name": "MPLS L2 Port",
      "number": 13
    },
    {
      "name": "MPLS L2 Port DSCP Trust",
      "number": 15
    },
    {
      "name": "MPLS L2 Port PCP Trust",
      "number": 16
    },
    {
      "name": "L2 Policer",
      "number": 18
    },
    {
      "name": "L2 Policer Actions",
      "number": 19
    },
    {
      "name": "Termination MAC",
      "number": 20
    },
    {
      "name": "L3 Type",
      "number": 21
    },
    {
      "name": "MPLS 0",
      "number": 23
    },
    {
      "name": "MPLS 1",
      "number": 24
    },
    {
      "name": "MPLS 2",
      "number": 25
    },
    {
      "name": "MPLS-TP Maintenance Point",
      "number": 26
    },
    {
      "name": "MPLS L3 Type",
      "number": 27
    },
    {
      "name": "MPLS Label Trust",
      "number": 28
    },
    {
      "name": "MPLS Type",
      "number": 29
    },
    {
      "name": "Unicast Routing",
      "number": 30
    },
    {
      "name": "Multicast Routing",
      "number": 40
    },
    {
      "name": "Bridging",
      "number": 50
    },
    {
      "name": "Policy ACL",
      "number": 60
    },
    {
      "name": "Color Based Actions",
      "number": 65
    },
    {
      "name": "Egress VLAN",
      "number": 210
    },
    {
      "name": "Egress VLAN 1",
      "number": 211
    },
    {
      "name": "Egress Maintenance Point",
      "number": 226
    },
    {
      "name": "Egress DSCP PCP Remark",
      "number": 230
    },
    {
      "name": "Egress TPID",
      "number": 235
    }
  ],
  "identifiers": [
    {
      "var": "<pport_no>",
      "doc": [
        "ifNum, 32-bit value. Physical ports in range 1..65535 (0x0000nnnn)."
      ]
    },
    {
      "var": "<lport_no>",
      "doc": [
        "ifNum, 32-bit value. Logical ports > 65536"
      ]
    },
    {
      "var": "<port_no>",
      "doc": [
        "ifNum, any port"
      ]
    },
    {
      "var": "<vid>",
      "range": "1..4095",
      "doc": [
        "12-bit VLAN id value from header field.",
        "OpenFlow requires VLAN_ID encoded as a 16-bit field with OFPVID_PRESENT set."
      ]
    },
    {
      "var": "<port_vid>",
      "range": "1..4095",
      "doc": [
        "VLAN id associated with a physical port and used for VLAN assignment.",
        "Must be only one port_vid value for a physical port.",
        "OpenFlow requires VLAN_ID encoded as a 16-bit field with OFPVID_PRESENT set.",
        "This value does not include OFPVID_PRESENT."
      ]
    },
    {
      "var": "<port_vid_2>",
      "range": "1..4095",
      "doc": [
        "VLAN id associated with a physical port and used if VLAN assignment sets a two VLAN id stack.",
        "Usually used for the outermost VLAN id.",
        "Must be only one port_vid_2 value for a physical port.",
        "OpenFlow requires VLAN_ID encoded as a 16-bit field with OFPVID_PRESENT set.",
        "This value does not include OFPVID_PRESENT."
      ]
    },
    {
      "var": "<overlay_tunnel_id>",
      "range": "0..2**16-1",
      "doc": [
        "Different ranges for different tunnel types.",
        "Non-tunnel packets from physical ports always have tunnel_id zero."
      ]
    },
    {
      "var": "<mpls_tunnel_id>",
      "range": "2**16..2**17-1",
      "doc": [
        "Different ranges for different tunnel types.",
        "Non-tunnel packets from physical ports always have tunnel_id zero."
      ]
    },
    {
      "var": "<eth_type>",
      "doc": [
        "Any valid ethertype, which will be  >1536 (0x0600),",
        "except for 0x8870 (jumbo frame)"
      ]
    },
    {
      "var": "<pcp>",
      "range": "0..7",
      "doc": [
        "VLAN header PCP field"
      ]
    },
    {
      "var": "<dei>",
      "range": "0..1",
      "doc": [
        "VLAN header DEI field"
      ]
    },
    {
      "var": "<qos_index>",
      "range": "0..255",
      "doc": [
        "index into a QoS table"
      ]
    },
    {
      "var": "<lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Lmep id provides connection between OpenFlow and OF-Config domains."
      ]
    },
    {
      "var": "<provider_lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate provider mdl when more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<mip_lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate mip (customer mdl) when more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<pw_lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate layer when more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<lsp_lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate layer when more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<section_lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate layer when more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<interface_lmep_id>",
      "range": "1..(2**32-1)",
      "doc": [
        "Differentiate interface mdlwhen more than one LMEP_Id is mentioned in the actions."
      ]
    },
    {
      "var": "<mdl>",
      "range": "0..7",
      "doc": [
        "Y.1731 OAM frame maintenance level."
      ]
    },
    {
      "var": "<mpls_l2_port>",
      "doc": [
        "Virtual ingress port for MPLS packets."
      ]
    },
    {
      "var": "<mac>",
      "doc": [
        "A MAC address"
      ]
    },
    {
      "var": "<local_mac>",
      "doc": [
        "Unicast MAC address of router."
      ]
    },
    {
      "var": "<meter_index>",
      "range": "1..65535 (0x0000nnnn)",
      "doc": [
        "Index into meter table."
      ]
    },
    {
      "var": "<color_actions_index>",
      "doc": [
        "Index into a color actions table.",
        "Pipeline metadata."
      ]
    },
    {
      "var": "<vrf>",
      "doc": [
        "VRF pipeline metadata."
      ]
    },
    {
      "var": "<ipv4_addr>",
      "doc": [
        "IPv4 Address - 32 bits represented as 4 decimal values - nnn.nnn.nnn.nnn"
      ]
    },
    {
      "var": "<ipv6_addr>",
      "doc": [
        "IPv6 Address - 128 bits represented as 8 groups of hex quartets - nnnn:nnnn:nnnn:nnnn:nnnn:nnnn:nnnn:nnnn"
      ]
    },
    {
      "var": "<ipv6_flabel>",
      "doc": [
        "IPv6 Flow Label - 20 bits"
      ]
    },
    {
      "var": "<ip_proto>",
      "range": "0..255",
      "doc": [
        "IP Header Protocol field."
      ]
    },
    {
      "var": "<ip_dscp>",
      "range": "0..64",
      "doc": [
        "IP Header DSCP field."
      ]
    },
    {
      "var": "<ip_ecn>",
      "range": "0..7",
      "doc": [
        "IP Header ECN field."
      ]
    },
    {
      "var": "<icmp_type>",
      "range": "0..255",
      "doc": [
        "ICMP Header Type field value."
      ]
    },
    {
      "var": "<icmp_code>",
      "range": "0..255",
      "doc": [
        "ICMP Header Code field value."
      ]
    },
    {
      "var": "<l3_in_port>",
      "doc": [
        " L3 Virtual Ingress Port, used for multicast forwarding.",
        "Pipeline metadata"
      ]
    },
    {
      "var": "<l4_port>",
      "range": "1..65535",
      "doc": [
        "16-bit TCP, UDP, or SCTP port number"
      ]
    },
    {
      "var": "<mpls_label>",
      "range": "1..1048575",
      "doc": [
        "20-bit label - reserved values should be excluded"
      ]
    },
    {
      "var": "<mpls_tc>",
      "range": "0..7",
      "doc": [
        "3-bit MPLS header TC field."
      ]
    },
    {
      "var": "<mpls_type>",
      "doc": [
        "VPWS(1); VPLS(2); MPLS-TP OAM(4); L3 Unicast (8); L3 Multicast(16); L3 PHP(32); Others Reserved."
      ]
    },
    {
      "var": "<counter_id>",
      "range": "0..2**32-1",
      "doc": [
        "Counter id for class and color based counters."
      ]
    },
    {
      "var": "<opcode>",
      "range": "0..255",
      "doc": [
        "Y.1731 header opcode field."
      ]
    },
    {
      "var": "<<group_entry_types:name>>",
      "doc": [
        "OF-DPA Group Entry Identifier (see Name Format in Group Entry Types)"
      ]
    },
    {
      "id": "PUSH_L2_HEADER",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 1,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "POP_L2_HEADER",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 2,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "PUSH_CW",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 3,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "POP_CW_OR_ACH",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 4,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "COPY_MPLS_TC_IN",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 5,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "COPY_MPLS_TC_OUT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 6,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "DEC_TTL_MTU",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 13,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "SET_MPLS_TC_FROM_VPN_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 7,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0.",
        "Sets MPLS_TC in PW shim header using current Traffic_Class and Color values",
        "Invoked from an MPLS VPN group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "SET_MPLS_PCPDEI_FROM_VPN_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 16,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0.",
        "Sets outer VLAN PCP for a PW using current Traffic_Class and Color values.",
        "Invoked from an MPLS VPN group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "SET_MPLS_TC_FROM_TUNNEL_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 17,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0.",
        "Sets MPLS_TC field in LSP shim header using current Traffic_Class and Color values.",
        "Invoked from an MPLS Tunnel group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "SET_MPLS_PCPDEI_FROM_TUNNEL_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 18,
      "doc": [
        "OF-DPA Action Identifier defined in OF-DPA 2.0.",
        "Sets outer VLAN PCP for an LSP using current Traffic_Class and Color values",
        "Invoked from an MPLS Tunnel group.",
        "Requires index argument with value <qos_index> to specify entry"
      ]
    },
    {
      "id": "COPY_FIELD",
      "type": "action",
      "exp_id": "0x4F4E4600",
      "exp_code": 3200,
      "doc": [
        "OpenFlow action defined in EXT-320."
      ]
    },
    {
      "id": "VRF",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 1,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "TRAFFIC_CLASS",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 2,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "COLOR",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 3,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "VLAN_DEI",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 4,
      "doc": [
        "OF-DPA Header Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "QOS_INDEX",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 5,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "LMEP_ID",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 6,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "MPLS_TTL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 7,
      "doc": [
        "OF-DPA Header Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "MPLS_L2_PORT",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 8,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "L3_IN_PORT",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 9,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "OVID",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 10,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "MPLS_DATA_FIRST_NIBBLE",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 11,
      "doc": [
        "OF-DPA Header Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "MPLS_ACH_CHANNEL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 12,
      "doc": [
        "OF-DPA Header Field Identifier defined in OF-DPA 2.0.",
        "Used for G.8113.1/Y.1732 OAM"
      ]
    },
    {
      "id": "NEXT_LABEL_IS_GAL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 13,
      "doc": [
        "OF-DPA Piepline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "OAM_Y1731_MDL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 14,
      "doc": [
        "OF-DPA Header Field Identifier defined in OF-DPA 2.0.",
        "Used for G.8013/Y.1731 OAM"
      ]
    },
    {
      "id": "OAM_Y1731_OPCODE",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 15,
      "doc": [
        "OF-DPA Header Field Identifier defined in OF-DPA 2.0.",
        "Used for G.8013/Y.1731 OAM"
      ]
    },
    {
      "id": "COLOR_ACTIONS_INDEX",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 16,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "PROTECTION_INDEX",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 21,
      "doc": [
        "OF-DPA Pipeline Field used to identify whether a label is for the working or protection path."
      ]
    },
    {
      "id": "ACTSET_OUTPUT",
      "type": "field",
      "exp_id": "0x04EA",
      "exp_code": 41,
      "doc": [
        "Pipeline Field that identifies the output port in an egress table (EXT-233)."
      ]
    },
    {
      "id": "MPLS_TYPE",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 23,
      "doc": [
        "OF-DPA Pipeline Field Identifier defined in OF-DPA 2.0."
      ]
    },
    {
      "id": "COPY_FIELD",
      "type": "action",
      "exp_id": "0x4F4E4600",
      "exp_code": 3200,
      "doc": [
        "Action defined in EXT-320."
      ]
    },
    {
      "id": "ALLOW_VLAN_TRANSLATION",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 24,
      "doc": [
        "Pipeline Field Identifier defined in SPTN OpenFlow Extensions."
      ]
    }
  ],
  "flow_tables": [
    {
      "name": "Ingress Port",
      "doc": [
        "First table in pipeline.",
        "Decapsulated overlay packets processed by Bridging table.",
        "Normal Ethernet packets processed by VLAN table.",
        "Injected OAM frames processed by Injected OAM table."
      ],
      "flow_mod_types": [
        {
          "name": "Normal Ethernet IPv4 DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the same",
            "QoS index values must be specified.",
            "<port> must be a physical port"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Normal Ethernet IPv6 DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the same",
            "QoS index values must be specified.",
            "<port> must be a physical port"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Normal Ethernet PCP",
          "priority": "4",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "<port> must be a physical port"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Port PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Normal Ethernet",
          "priority": "3",
          "doc": [
            "Lowest priority",
            "<pport_no>  must be a physical port"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel IPV4  DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the",
            "same QoS index values must be sepcified.",
            "<lport_no> must be a tunnel logical port",
            "<overlay_tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Tunnel DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel IPv6 DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the same.",
            "QoS index values must be sepcified.",
            "<lport_no> must be a tunnel logical port",
            "<overlay_tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Tunnel DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel PCP",
          "priority": "4",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "<lport_no> must be a tunnel logical port",
            "<overlay_tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Tunnel PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel",
          "priority": "3",
          "doc": [
            "Matches unclassified tunnel overlaid packets.",
            "Must be lower priority than overlapping rules .",
            "<overlay_tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        },
        {
          "name": "OAM PDU Injection",
          "priority": "6",
          "doc": [
            "Matches injected Y.1732 frames.on a port.",
            "<lmep_id> must be non-zero."
          ],
          "match_set": [
            {
              "field": "$LMEP_ID",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Injected OAM"
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Built-in Normal Ethernet VLAN",
          "priority": "0",
          "doc": [
            "Built-in default rule for packets that are not tunnel packets.",
            "Matches any frame with zero <tunnel_id>."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Drop overlay packet miss. Fixed, cannot be modified or deleted."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "Port DSCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification IPv4",
          "priority": "1",
          "doc": [
            "Classify ingress IP packet by DSCP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Trust Classification IPv6",
          "priority": "1",
          "doc": [
            "Classify ingress IP packet by DSCP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        }
      ]
    },
    {
      "name": "Port PCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification",
          "priority": "1",
          "doc": [
            "VLAN present prerequisite is required by OpenFlow."
          ],
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        }
      ]
    },
    {
      "name": "Tunnel PCP Trust",
      "doc": [
        "Classify traffic class and color based on VLAN PCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification",
          "priority": "1",
          "doc": [
            "VLAN present prerequisite is required by OpenFlow."
          ],
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "Tunnel DSCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification IPv4",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Trust Classification IPv6",
          "priority": "1",
          "doc": [
            "Classify ingress IP packet by DSCP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "Injected OAM",
      "doc": [
        "Injected OAM frames are Y.1731 Ethernet.",
        "MPLS-TP OAM frames output encapsulated and forwarded."
      ],
      "flow_mod_types": [
        {
          "name": "Ethernet Service Up MEP or MHF",
          "priority": "1",
          "doc": [
            "Inject into MPLS tunnel pipeline before forwarding and conditioning.",
            "LMEP id, Traffic Class and Color pipeline metadata with packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_id",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_VID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            }
          ]
        },
        {
          "name": "Section",
          "priority": "1",
          "doc": [
            "Send to next hop.",
            "LMEP id, Traffic Class and Color pipeline metadata with packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_id",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "LSP MEP or MIP",
          "priority": "1",
          "doc": [
            "LMEP id, Traffic Class and Color pipeline metadata with packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_id",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV Type 1 or 3",
          "priority": "1",
          "doc": [
            "LMEP id, Traffic Class and Color pipeline metadata with packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_id",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Tunnel Label 1>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV Type 4",
          "priority": "1",
          "doc": [
            "LMEP id, traffic class and color metadata with packet.",
            "Push GAL then label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_id",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": 13
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "$PUSH_CW"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_DATA_FIRST_NIBBLE",
                  "value": 1
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_ACH_CHANNEL",
                  "value": "0x8902"
                },
                {
                  "action": "PUSH_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_LABEL",
                  "value": "<mpls_label>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_BOS",
                  "value": "1"
                },
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "MPLS_TC",
                      "value": "<exp>"
                    },
                    {
                      "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                      "value": "<qos_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Tunnel Label 1>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Drop.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "VLAN",
      "doc": [
        "Ingress VLAN Assignment and Translation.",
        "If Ethernet Service MIP configured send frame to Ingress Maintenance Point.",
        "Process two tags by assigning metadata, pop, go to VLAN 1 to process inner tag."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Filtering",
          "priority": "3",
          "doc": [
            "Matches outer VLAN ID."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Assignment - Untagged  (Port VLAN Assignment)",
          "priority": "3",
          "doc": [
            "Port VLAN assignment for untagged frame.",
            "Can push one or two VLAN tags with TPID 0x8100.",
            "If resulting packet has one tag, port_vid represents the outer VLAN.",
            "If resulting packet has two tags, port_vid represents the inner and port_vid_2 the outer VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_ID",
                  "value": "<port_vid>|0x1000"
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<port_vid_2>|0x1000"
                        }
                      ]
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Assignment -  Priority Tagged (Port VLAN Assignment)",
          "priority": "3",
          "doc": [
            "Port VLAN assignment for priority tagged frame.",
            "Can push one or two VLAN tags with TPID 0x8100.",
            "If resulting packet has one tag, port_vid represents the outer VLAN.",
            "If resulting packet has two tags, port_vid represents the inner and port_vid_2 the outer VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_ID",
                  "value": "<port_vid>|0x1000"
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<port_vid_2>|0x1000"
                        }
                      ]
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Allow All",
          "priority": "7",
          "doc": [
            "A port cannot have conflicting VLAN match and all traffic rules.",
            "Turns off VLAN filtering for tagged frames."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Translate Single Tag or Single Tag to Double Tag",
          "priority": "2",
          "doc": [
            "VLAN modifications for single tagged frame.",
            "If resulting packet has one tag, port_vid represents the outer VLAN.",
            "If resulting packet has two tags, port_vid represents the inner and port_vid_2 the outer VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>|0x1000"
                        }
                      ]
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Translate Double Tag",
          "priority": "2",
          "doc": [
            "VLAN modifications for double tagged frame.",
            "OVID is new pipeline metadata and used by VLAN 1 Table to match two VLAN ids."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>|0x1000"
                },
                {
                  "action": "POP_VLAN"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Single Tag Translate",
          "priority": "5",
          "doc": [
            "MPLS match criteria - single tagged VLAN.",
            "A port cannot have conflicting VLAN match and all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured. ",
            "MPLS_TYPE can only be set to VPWS."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    },
                    {
                      "action": "POP_VLAN"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Double Tag Translate",
          "priority": "5",
          "doc": [
            "MPLS match criteria - double tagged VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>|0x1000"
                },
                {
                  "action": "POP_VLAN"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Untagged ",
          "priority": "5",
          "doc": [
            "MPLS Match criteria untagged packet. Pushes and sets outer VLAN.",
            "A port cannot have conflicting untagged VLAN match and all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured. ",
            "MPLS_TYPE can only be set to VPWS."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>|0x1000"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2  Priority Tagged",
          "priority": "5",
          "doc": [
            "MPLS Match criteria priority tagged. Sets outer VLAN.",
            "A port cannot have conflicting untagged VLAN match and all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured. ",
            "MPLS_TYPE can only be set to VPWS."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    },
                    {
                      "action": "POP_VLAN"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 All Traffic on Port",
          "priority": "6",
          "doc": [
            "MPLS - all traffic on port (VLAN match omitted, highest priority). ",
            "A port cannot have conflicting VLAN match and  all traffic rules.",
            "Next table is Ingress Maintenance Point if MEP or MIP configured.",
            "MPLS_TYPE can only be set to VPWS."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop rule, no VLAN for frame.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "VLAN 1",
      "doc": [
        "Used to process inner tag.",
        "Final packet can be untagged, single tagged, or double tagged."
      ],
      "flow_mod_types": [
        {
          "name": "Stacked VLAN Assignment",
          "priority": "2",
          "doc": [
            "Can restore VLAN stack by pushing the OVID that was matched on "
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$OVID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>|0x1000"
                        }
                      ]
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Stacked VLAN",
          "priority": "2",
          "doc": [
            "Can restore VLAN stack by pushing the OVID that was matched on ",
            "Next table is Ingress Maintenance Point if MIP configured. "
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$OVID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS L2 Port"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Ingress Maintenance Point"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>|0x1000"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop rule, unable to process stacked VLAN tags,",
            "Restore outer VLAN id in packet.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "<eth_type>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_ID",
                  "value": "<ovid>|0x1000"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Ingress Maintenance Point",
      "doc": [
        "Process packets for Ethernet Service OAM MIP or MEP from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "Down MHF LBM Process (Client MDL)",
          "priority": "5",
          "doc": [
            "Configure MIP (LTM to local MAC) at this MDL."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "3",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_DST",
              "value": "<local_mac>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<mip_lmep_id>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "Down MHF LTM Process (Client MDL)",
          "priority": "4",
          "doc": [
            "Configure MIP (LTR, destination MAC is Class 2 Multicast) at this MDL."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "5",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<mip_lmep_id>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Process (our MDL)",
          "priority": "5",
          "doc": [
            "Process all PDUs at specified MDL. PDU can be either Provider or Interface level.",
            "Provider LM counts Interface PDUs."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<interface_lmep_id>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Passthru - higher MDL",
          "priority": "3",
          "doc": [
            "Must be programmed to pass higher MDL PDUs for this user and treat as data.",
            "MDL higher than provider, check for LCK and provider Tx count.",
            "MDL higher than interface (generally level 0) interface Rx count.",
            "Without these entries PDUs may be dropped unnecessarily."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Drop (lower MDL)",
          "priority": "2",
          "doc": [
            "Must be programmed to enable active filtering of lower MDL than provider -",
            "(interface PDUs already processed in higher priority rule).",
            "The optional output is so OAM engine can generate drop notification."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "MEP Data",
          "priority": "1",
          "doc": [
            "For provider MEP optionally check for LCK and Tx Count.",
            "For interface MEP optionally Rx count."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Not sure what to do with this packet, supposed to be a MIP or MEP here.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port",
      "doc": [
        "Represents ingress port for MPLS service flow from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS v4 DSCP",
          "priority": "4",
          "doc": [
            "Fowarding decision required for VPWS.",
            "IPv4 DSCP simple classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS v6 DSCP",
          "priority": "4",
          "doc": [
            "Fowarding decision required for VPWS.",
            "IPv6 DSCP simple classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS PCP",
          "priority": "3",
          "doc": [
            "Fowarding decision required for VPWS.",
            "PCP simple classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VPWS",
          "priority": "2",
          "doc": [
            "Fowarding decision required for VPWS.",
            "No QoS trust classification."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default, skip simple classification.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port DSCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to MPLS QoS Classifier Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port PCP Trust",
      "doc": [
        "Classify traffic class and color based on VLAN PCP field."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS-TP Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            },
            {
              "field": "VLAN _PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to MPLS QoS Classifier Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            }
          ]
        }
      ]
    },
    {
      "name": "Termination MAC",
      "doc": [
        "Determine whether to bridge, route, or MPLS process a packet.",
        "Bridge packet if MAC destination is other than local.",
        "If local MAC then use ETH-TYPE to decide how to process."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Unicast MAC",
          "priority": "2",
          "doc": [
            "IPv4 unicast routing."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Unicast Routing"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "L3 Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Unicast MAC",
          "priority": "2",
          "doc": [
            "IPv6 unicast routing."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Unicast Routing"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "L3 Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Multicast MAC",
          "priority": "2",
          "doc": [
            "Enables IPv4 multicast routing."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "01-00-5e-00-00-00",
              "match_type": "mask",
              "mask": " ff-ff-ff-80-00-00"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast MAC",
          "priority": "2",
          "doc": [
            "Enables IPv6 multicast routing."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "33-33-00-00-00-00",
              "match_type": "mask",
              "mask": "ff-ff-00-00-00-00"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS",
          "priority": "2",
          "doc": [
            "MPLS termination."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS 0"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS 1"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default on miss is to switch packet.",
            "Fixed rule. Cannot be  modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Type",
      "doc": [
        "Do Multicast Routing for packets with Multicast DIP even if Unicast DMAC.",
        "This table cannot be modified by the controller."
      ],
      "flow_mod_types": [],
      "built_in_flow_mods": [
        {
          "name": "IPv4 Multicast IP",
          "priority": "3",
          "doc": [
            "Unicast MAC with Multicast IPv4 DIP",
            "Fixed rule. Cannot be  modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "224.0.0.0",
              "match_type": "mask",
              "mask": "224.0.0.0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            }
          ]
        },
        {
          "name": "IPv6 Multicast IP",
          "priority": "3",
          "doc": [
            "Unicast MAC with Multicast IPv6 DIP",
            "Fixed rule. Cannot be  modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "ff00:0:0:0:0:0:0:0",
              "match_type": "mask",
              "mask": "ff00:0:0:0:0:0:0:0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            }
          ]
        },
        {
          "name": "Default miss",
          "priority": "0",
          "doc": [
            "Default on miss is to switch packet.",
            "Fixed rule. Cannot be  modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 0",
      "doc": [
        "Match outermost MPLS label.",
        "Used for three label processing scenarios.",
        "Miss continues to MPLS 1."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label (no MEP)",
          "priority": "1",
          "doc": [
            "LSP terminate, ring or divert label.  No MEP on label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (MEP Data)",
          "priority": "1",
          "doc": [
            "LSP terminate, ring or divert label. Label has MEP with LM"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (MEP Control)",
          "priority": "2",
          "doc": [
            "LSP terminate ring or divert label. Label has MEP, OAM Control PDU",
            "Pop GAL label and make packet look like an Ethernet OAM frame",
            "Higher priority than non-OAM rule for this label, which must be installed first."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lsp_lmep_id>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Built-in default on miss.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 1",
      "doc": [
        "First MPLS match table. Matches outermost MPLS shim header.",
        "Contains same flow entries as MPLS 2",
        "Updating MPLS 1 updates MPLS 2."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label",
          "priority": "1",
          "doc": [
            "LSP termination. Action on next label.",
            "This label does not have a MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on this label (PHP)",
          "priority": "1",
          "doc": [
            "LSP termination. PHP so no maintenance point."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label and forward based on this label",
          "priority": "1",
          "doc": [
            "LSP Swap. This label does not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label and forward based on this label",
          "priority": "1",
          "doc": [
            "PW Swap, like LSP swap but BOS. Used for MS-PW.",
            "This label doess not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP MEP Data)",
          "priority": "1",
          "doc": [
            "LSP termination. Action on next label.",
            "This label has a MEP with LM enabled and this is a data frame.",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP MEP Control)",
          "priority": "2",
          "doc": [
            "LSP termination but  MEP on label and OAM PDU.",
            "Pop GAL and make packet look like an Ethernet OAM frame.",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lsp_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label (LSP OAM MIP Control)",
          "priority": "2",
          "doc": [
            "LSP swap with MIP on label and OAM PDU. No LM/DM on MIP.",
            "Pop GAL and make packet look like an Ethernet OAM frame",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<mip_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label (MS-PW OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop PW label and make packet look like an Ethernet OAM frame."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch  (PW Terminate)",
          "priority": "1",
          "doc": [
            "PW Terminate.",
            "Group needs to be supplied if MPLS_TYPE is VPWS.",
            "Optional actions if MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<networkl_mpls_l2_port>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 4 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "OAM enabled, next label is GAL.",
            "Pop PW and GAL, make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule for a label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 1 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 3 (OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MIP control packet.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section OAM",
          "priority": "5",
          "doc": [
            "Section OAM - Match GAL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "13",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "match_type",
              "value": "exact",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<section_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route",
          "priority": "4",
          "doc": [
            "L3 Route.",
            "MPLS L3 Type determines IP version and whether unicast or multicast."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L3 Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$L3_IN_PORT",
                  "value": "<l3_in_port>"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward",
          "priority": "4",
          "doc": [
            "L3 Forward (no routing lookup). Set MPLS_TYPE.",
            "MPLS L3 Type determines IP version.",
            "Next hop is forwarding router."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L3 Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<L3 PHP>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "PW OAM Unexpected Control",
          "priority": "0",
          "doc": [
            "PW Unexpected OAM (ACH control frame) - Drop",
            "This event should be a notification",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 2",
      "doc": [
        "Second MPLS match table. Matches outermost label after pop.",
        "Cannot be updated directly, must be via MPLS 1 update."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label",
          "priority": "1",
          "doc": [
            "LSP termination. Action on next label.",
            "This label does not have a MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on this label (PHP)",
          "priority": "1",
          "doc": [
            "LSP termination. PHP so no maintenance point."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label and forward based on this label",
          "priority": "1",
          "doc": [
            "LSP Swap. This label does not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label and forward based on this label",
          "priority": "1",
          "doc": [
            "PW Swap, like LSP swap but BOS. Used for MS-PW.",
            "This label doess not have a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP MEP Data)",
          "priority": "1",
          "doc": [
            "LSP termination. Action on next label.",
            "This label has a MEP with LM enabled and this is a data frame.",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP MEP Control)",
          "priority": "2",
          "doc": [
            "LSP termination but  MEP on label and OAM PDU.",
            "Pop GAL and make packet look like an Ethernet OAM frame.",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lsp_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label (LSP OAM MIP Control)",
          "priority": "2",
          "doc": [
            "LSP swap with MIP on label and OAM PDU. No LM/DM on MIP.",
            "Pop GAL and make packet look like an Ethernet OAM frame",
            "If Section MEP has LM enabled, can optionally match VLAN Id and count."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<mip_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label (MS-PW OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop PW label and make packet look like an Ethernet OAM frame."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch  (PW Terminate)",
          "priority": "1",
          "doc": [
            "PW Terminate.",
            "Group needs to be supplied if MPLS_TYPE is VPWS.",
            "Optional actions if MEP with LM enabled."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Label Trust"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<mpls_tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<networkl_mpls_l2_port>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<mpls_type>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 4 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "OAM enabled, next label is GAL.",
            "Pop PW and GAL, make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule for a label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 1 (PW Terminate OAM MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP OAM PDU.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW VCCV 3 (OAM MIP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MIP control packet.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<pw_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section OAM",
          "priority": "5",
          "doc": [
            "Section OAM - Match GAL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "13",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "match_type",
              "value": "exact",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<section_lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route",
          "priority": "4",
          "doc": [
            "L3 Route.",
            "MPLS L3 Type determines IP version and whether unicast or multicast."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L3 Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$L3_IN_PORT",
                  "value": "<l3_in_port>"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward",
          "priority": "4",
          "doc": [
            "L3 Forward (no routing lookup). Set MPLS_TYPE.",
            "MPLS L3 Type determines IP version.",
            "Next hop is forwarding router."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L3 Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "all": [
                        {
                          "action": "$COPY_FIELD",
                          "field": "MPLS_TC",
                          "value": "$PACKET_REGS(0)"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$QOS_INDEX",
                          "value": "<qos_index>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<L3 PHP>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "PW OAM Unexpected Control",
          "priority": "0",
          "doc": [
            "PW Unexpected OAM (ACH control frame) - Drop",
            "This event should be a notification",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default drop",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Label Trust",
      "doc": [
        "Classify traffic class and color based on MPLS_TC field."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS-TP Trust",
          "priority": "1",
          "doc": [
            "Set Traffic Class and Color."
          ],
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "$PACKET_REGS(0)",
              "value": "<mpls_tc>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default pass through.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Type",
      "doc": [
        "Goto table based on MPLS type pipeline field."
      ],
      "flow_mod_types": [],
      "built_in_flow_mods": [
        {
          "name": "VPWS",
          "priority": "0",
          "doc": [
            "MPLS-TP VPWS, go to Policy ACL Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "$MPLS_TYPE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        },
        {
          "name": "L3 Route Unicast",
          "priority": "0",
          "doc": [
            "L3 Unicast, go to Unicast Routing.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "$MPLS_TYPE",
              "value": "8",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            }
          ]
        },
        {
          "name": "L3 Route Multicast",
          "priority": "0",
          "doc": [
            "L3 Multicast, go to Multicast Table.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "$MPLS_TYPE",
              "value": "16",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            }
          ]
        },
        {
          "name": "L3 PHP",
          "priority": "0",
          "doc": [
            "L3 forward.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "$MPLS_TYPE",
              "value": "32",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        },
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default on miss.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS-TP Maintenance Point",
      "doc": [
        "Process OAM frame for G.8113.1 Down MEP or MIP."
      ],
      "flow_mod_types": [
        {
          "name": "MEP PDU Process G.8113.1",
          "priority": "3",
          "doc": [
            "ETH-TYPE is to satisfy OpenFlow prerequisite."
          ],
          "match_set": [
            {
              "field": "LMEP ID",
              "value": "<lmep_id>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default rule, built in. ",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L3 Type",
      "doc": [
        "Decodes L3 packet type after MPLS L3 termination."
      ],
      "flow_mod_types": [],
      "built_in_flow_mods": [
        {
          "name": "L3 VPN Route (IPv4 Unicast)",
          "priority": "1",
          "doc": [
            "L3 Route. Not OAM enabled.",
            "MPLS_TC argument supplied from packet  for QoS table lookup.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Label Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<L3 Unicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv4 Multicast)",
          "priority": "2",
          "doc": [
            "L3 Route.",
            "Destination MAC set to an appropriate multicast address",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "224.0.0.0",
              "match_type": "mask",
              "mask": "224.0.0.0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Label Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                },
                {
                  "action": "SET_FIELD",
                  "field": "MAC_DST",
                  "value": " <mac>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<L3 Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv6 Unicast)",
          "priority": "3",
          "doc": [
            "L3 Route.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Label Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<L3 Unicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv6 Multicast)",
          "priority": "4",
          "doc": [
            "L3 Route.",
            "L3_IN_PORT used for multicast L3 source removal.",
            "Destination MAC set to an appropriate multicast address",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "FF00:0:0:0:0:0:0:0",
              "match_type": "mask",
              "mask": "FF00:0:0:0:0:0:0:0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Label Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                },
                {
                  "action": "SET_FIELD",
                  "field": "MAC_DST",
                  "value": " <mac>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_TYPE",
                  "value": "<L3 Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward (IPv4) based on this label (PHP)",
          "priority": "5",
          "doc": [
            "L3 Forward (no routing lookup)",
            "Rule sets the Ethertype.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_TYPE",
              "value": "L3 PHP",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Label Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward (IPv6) based on this label (PHP)",
          "priority": "6",
          "doc": [
            "L3 Forward (no routing lookup)",
            "Rule sets the Ethertype.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_TYPE",
              "value": "L3 PHP",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Label Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                }
              ]
            }
          ]
        },
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default drop",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Unicast Routing",
      "doc": [
        "Supports exact and LPM match on IP destination address"
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Unicast Host",
          "priority": "3",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv4_dst>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": {
                "exactly_one": [
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 Unicast>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 ECMP>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<MPLS L3 VPN Label>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "action": "OUTPUT",
                    "port": "CONTROLLER"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "IPv4 Unicast LPM",
          "priority": "2",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv4_dst>",
              "match_type": "prefix"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": {
                "exactly_one": [
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 Unicast>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 ECMP>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<MPLS L3 VPN Label>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "action": "OUTPUT",
                    "port": "CONTROLLER"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "IPv6 Unicast Host",
          "priority": "3",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv6_d>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": {
                "exactly_one": [
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 Unicast>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 ECMP>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<MPLS L3 VPN Label>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "action": "OUTPUT",
                    "port": "CONTROLLER"
                  }
                ]
              }
            }
          ]
        },
        {
          "name": "IPv6 Unicast LPM",
          "priority": "2",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv6_d>",
              "match_type": "prefix"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": {
                "exactly_one": [
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 Unicast>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<L3 ECMP>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "all": [
                      {
                        "action": "GROUP",
                        "group_id": "<MPLS L3 VPN Label>"
                      },
                      {
                        "action": "DEC_NW_TTL"
                      }
                    ]
                  },
                  {
                    "action": "OUTPUT",
                    "port": "CONTROLLER"
                  }
                ]
              }
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default pass through, Policy ACL must forward or packet dropped.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "Multicast Routing",
      "doc": [
        "Routes IPv4 and IPv6 multicast frames.",
        "VLAN Id or L2_IN_PORT used for source removal."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Multicast",
          "priority": "1",
          "doc": [
            "Specific IPv4 multicast group address",
            "VLAN_ID used for source removal"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "<ipv4_addr>",
              "match_type": "exact",
              "const_mask": "224.0.0.0",
              "const_value": "224.0.0.0"
            },
            {
              "field": "IPV4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "DEC_NW_TTL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast",
          "priority": "1",
          "doc": [
            "Specific IPv6 multicast group address",
            "VLAN_ID used for source removal"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "exact",
              "const_mask": "ff00:0:0:0:0:0:0:0 ",
              "const_value": "ff00:0:0:0:0:0:0:0"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "DEC_NW_TTL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Multicast MPLS L3 VPN",
          "priority": "2",
          "doc": [
            "Specific IPv4 multicast group address",
            "Used for MPLS L3 VPN",
            "L3_IN_PORT used for source removal"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "<ipv4_addr>",
              "match_type": "exact",
              "const_mask": "224.0.0.0",
              "const_value": "224.0.0.0"
            },
            {
              "field": "IPV4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$L3 IN_PORT",
              "value": "<l3_in_port>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "DEC_NW_TTL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast MPLS L3 VPN",
          "priority": "2",
          "doc": [
            "Specific IPv6 multicast group address",
            "Used for MPLS L3 VPN",
            "L3_IN_PORT used for source removal"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "exact",
              "const_mask": "ff00:0:0:0:0:0:0:0 ",
              "const_value": "ff00:0:0:0:0:0:0:0"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$L3 IN_PORT",
              "value": "<l3_in_port>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "DEC_NW_TTL"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default pass through, Policy ACL must forward or packet dropped.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "Bridging",
      "doc": [
        "L2 switching based on destination MAC and VLAN or Tunnel Id.",
        "Tunnel used for forwarding in isolated overlay domain."
      ],
      "flow_mod_types": [
        {
          "name": "Unicast VLAN",
          "priority": "3",
          "doc": [
            "Switch packet in VLAN."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "00-00-00-00-00-00"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Multicast VLAN",
          "priority": "3",
          "doc": [
            "Replicate packet in VLAN."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "01-00-00-00-00-00"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "DLF VLAN",
          "priority": "2",
          "doc": [
            "Flood packet in VLAN."
          ],
          "match_set": [
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Flood>"
                }
              ]
            }
          ]
        },
        {
          "name": "Unicast Overlay",
          "priority": "5",
          "doc": [
            "Switch packet in tenant forwarding domain."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "00-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "<lport_no>"
                }
              ]
            }
          ]
        },
        {
          "name": "Multicast Overlay",
          "priority": "5",
          "doc": [
            "Replicate packet in tenant forwarding domain."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "01-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "Overlay Multicast"
                }
              ]
            }
          ]
        },
        {
          "name": "DLF Overlay",
          "priority": "4",
          "doc": [
            "Flood packet in tenant forwarding domain."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "Overlay Flood"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default pass through, Policy ACL must forward or packet dropped.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Policer",
      "doc": [
        "Per-service meters applied to Ethernet Service frames from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS_L2_Port  Meter",
          "priority": "2",
          "doc": [
            "Must be a UNI-NNI flow (MPLS_L2_Port is local).",
            "Meter index must be greater than 0xffff."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<local_mpls_l2_port>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "<meter_index>"
            },
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "L2 Policer Actions"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": "<index>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Policer Actions",
      "doc": [
        "Actions based on packet color.",
        "Must be separate from L2 Policer table."
      ],
      "flow_mod_types": [
        {
          "name": "Green Actions",
          "priority": "2",
          "doc": [
            "Optional, but must clear the color actions index.",
            "If CLEAR ACTIONS next table must be Policy ACL."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": 0
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Yellow Actions",
          "priority": "2",
          "doc": [
            "Optional, but must clear the color actions index.",
            "If CLEAR ACTIONS next table must be Policy ACL."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": 0
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Red Actions",
          "priority": "2",
          "doc": [
            "Optional, but must clear the color actions index.",
            "If CLEAR ACTIONS next table must be Policy ACL."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "2",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "exactly_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "MPLS Type"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": 0
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": " Default",
          "priority": "0",
          "doc": [
            "Built-in rule, no action on a miss, but clear color actions index.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS Type"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": 0
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Policy ACL",
      "doc": [
        "Match on variety of fields.",
        "Can redirect, drop, meter, copy-to-CONTROLLER, etc."
      ],
      "flow_mod_types": [
        {
          "name": "IPv6 VLAN",
          "priority": "4",
          "doc": [
            "IPv6 - switched/bridged packet including encapsulated MPLS"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv6_DST",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_FLABEL",
              "value": "<ipv6_flabel>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "METER",
                  "meter_name": "<<meter_index>>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Color Based Actions"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR_ACTIONS_INDEX",
                          "value": "<color_actions_index>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR",
                          "value": "<color>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic-class>"
                        },
                        {
                          "action": "OUTPUT",
                          "port": "CONTROLLER"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered_Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Rewrite>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Unicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 ECMP>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Overlay",
          "priority": "3",
          "doc": [
            "IPv6 - tunneled Ethernet packet"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv6_DST",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_FLABEL",
              "value": "<ipv6_flabel>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "METER",
                  "meter_name": "<<meter_index>>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Color Based Actions"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR_ACTIONS_INDEX",
                          "value": "<color_actions_index>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR",
                          "value": "<color>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic-class>"
                        },
                        {
                          "action": "OUTPUT",
                          "port": "CONTROLLER"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "OUTPUT",
                          "port": "<lport_no>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Overlay Multicast>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 MPLS-TP",
          "priority": "4",
          "doc": [
            "IPv6 - inner Ethernet packet (initiation or termination)"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv6_DST",
              "value": "<ipv6_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_FLABEL",
              "value": "<ipv6_flabel>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "METER",
                  "meter_name": "<<meter_index>>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Color Based Actions"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR_ACTIONS_INDEX",
                          "value": "<color_actions_index>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR",
                          "value": "<color>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic-class>"
                        },
                        {
                          "action": "OUTPUT",
                          "port": "CONTROLLER"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered_Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Rewrite>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Unicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 ECMP>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 VLAN",
          "priority": "2",
          "doc": [
            "IPv4 - switched/bridged packet including encapsulated MPLS"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ARP_SPA",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "METER",
                  "meter_name": "<<meter_index>>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Color Based Actions"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR_ACTIONS_INDEX",
                          "value": "<color_actions_index>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR",
                          "value": "<color>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic-class>"
                        },
                        {
                          "action": "OUTPUT",
                          "port": "CONTROLLER"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered_Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Rewrite>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Unicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 ECMP>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Overlay",
          "priority": "1",
          "doc": [
            "IPv4 - tunneled Ethernet packet"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<overlay_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ARP_SPA",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "METER",
                  "meter_name": "<<meter_index>>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Color Based Actions"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR_ACTIONS_INDEX",
                          "value": "<color_actions_index>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR",
                          "value": "<color>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic-class>"
                        },
                        {
                          "action": "OUTPUT",
                          "port": "CONTROLLER"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "OUTPUT",
                          "port": "<lport_no>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Overlay Multicast>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 MPLS-TP",
          "priority": "2",
          "doc": [
            "IPv4 - inner Ethernet packet (initiation or termination)"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<mpls_tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<ip_proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<ip_ecn>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "<icmp_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "<icmp_code>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "<l4_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact"
            },
            {
              "field": "ARP_SPA",
              "value": "<ipv4_addr>",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "METER",
                  "meter_name": "<<meter_index>>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Color Based Actions"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR_ACTIONS_INDEX",
                          "value": "<color_actions_index>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$COLOR",
                          "value": "<color>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "$TRAFFIC_CLASS",
                          "value": "<traffic-class>"
                        },
                        {
                          "action": "OUTPUT",
                          "port": "CONTROLLER"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "WRITE_ACTIONS",
                  "actions": [
                    {
                      "zero_or_one": [
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Unfiltered_Interface>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Rewrite>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L2 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Unicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 Multicast>"
                        },
                        {
                          "action": "GROUP",
                          "group_id": "<L3 ECMP>"
                        }
                      ]
                    },
                    {
                      "zero_or_more": [
                        {
                          "action": "SET_FIELD",
                          "field": "IP_DSCP",
                          "value": "<ip_dscp>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "IP_ECN",
                          "value": "<ip_ecn>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_PCP",
                          "value": "<pcp>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Process the action set.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    },
    {
      "name": "Color Based Actions",
      "doc": [
        "Apply color based actions after metering in Policy ACL.",
        "Must be a separate table."
      ],
      "flow_mod_types": [
        {
          "name": "Green Actions",
          "priority": "2",
          "doc": [
            "Clear-actions with no next table is used for drop.",
            "Change Traffic Class (changes OUTPUT priority queue)."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Yellow Actions",
          "priority": "2",
          "doc": [
            "Clear-actions with no next table is used for drop.",
            "Change Traffic Class (changes OUTPUT priority queue)."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Red Actions",
          "priority": "2",
          "doc": [
            "Clear-actions with no next table is used for drop.",
            "Change Traffic Class (changes OUTPUT priority queue)."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "2",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ip_ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Default passthrough.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    },
    {
      "name": "Egress VLAN",
      "doc": [
        "Used for Egress VLAN Translation.",
        "If Ethernet Service OAM MIP or Up MEP then send frame to Egress Maintenance Point."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Translate Single Tag, optional MIP and/or MEP",
          "priority": "2",
          "doc": [
            "Final packet can be single tagged or double tagged.",
            "If MIP and/or MEP go to Egress Maintenance Point,",
            "otherwise OUTPUT packet."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress Maintenance Point"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress DSCP PCP Remark"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    },
                    {
                      "action": "POP_VLAN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>|0x1000"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Translate Double Tag",
          "priority": "2",
          "doc": [
            "Process as double tagged packet."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress VLAN 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>|0x1000"
                },
                {
                  "action": "POP_VLAN"
                }
              ]
            }
          ]
        },
        {
          "name": "MIP and/or MEP",
          "priority": "1",
          "doc": [
            "MIP and/or MEP, go to Egress Maintenance Point"
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            },
            {
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": "0",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress Maintenance Point"
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Output packet on miss.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress DSCP PCP Remark"
            }
          ]
        }
      ]
    },
    {
      "name": "Egress VLAN 1",
      "doc": [
        "Used to process inner tag on double tagged packets.",
        "Final packet can be untagged, single tagged, or double tagged."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Translate Double to Single or Double",
          "priority": "1",
          "doc": [
            "Final packet can be single tagged or double tagged"
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            },
            {
              "field": "$OVID",
              "value": "<vid>|0x1000",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress Maintenance Point"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress DSCP PCP Remark"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>|0x1000"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "all": [
                        {
                          "action": "PUSH_VLAN",
                          "ethertype": "0x8100"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>|0x1000"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table misss",
          "priority": "0",
          "doc": [
            "Restore double tags and output packet on miss.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress DSCP PCP Remark"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>|0x1000"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Egress Maintenance Point",
      "doc": [
        "Process OAM frame for MIP or Up MEP.",
        "Data frames may be counted and forwarded."
      ],
      "flow_mod_types": [
        {
          "name": "Up MHF PDU Process (LBM)",
          "priority": "5",
          "doc": [
            "Ethernet Service MIP (LBM).",
            "LMEP_Id is of MIP",
            "Drop and send to LOCAL engine.",
            "Could be up to seven levels in theory."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "3",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_DST",
              "value": "<local_mac>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<mip_lmep_id>"
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "Up MHF PDU Process (our LTM)",
          "priority": "5",
          "doc": [
            "Ethernet Service MIP (LTM).",
            "LMEP_Id is of MIP",
            "Drop and send to LOCAL engine.",
            "Could be up to seven levels in theory."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "5",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_DST",
              "value": "01-80-c2-00-00-38",
              "match_type": "mask",
              "mask": "ff-ff-ff-ff-ff-ff-f8"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<mip_lmep_id>"
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Process (our MDL)",
          "priority": "4",
          "doc": [
            "Process all PDUs at Provider MDL.",
            "LMEP_Id is of Provider MEP",
            "Drop and send to LOCAL engine."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<provider_lmep_id>"
                },
                {
                  "action": "OUTPUT",
                  "port": "LOCAL"
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Passthrough (higher MDL)",
          "priority": "3",
          "doc": [
            "For Ethernet OAM packets must  be programmed to pass through higher MDL.",
            "Packet forwarded to original OUTPUT port.",
            "LMEP_Id is of Provider MEP in LCK and LM counter.",
            "Could be up to seven levels in theory."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": []
            }
          ]
        },
        {
          "name": "PDU Drop (lower MDL)",
          "priority": "2",
          "doc": [
            "Must be programmed for active filtering. Applies to both MIP and MEP.",
            "Can selectively notify by message, usually just for CCM.",
            "Drop and send to LOCAL engine for optional notification."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Data Passthough (Provider Up MEP Rx from partner and/or CFM Down MEP TX to partner)",
          "priority": "1",
          "doc": [
            "Override default rule for Provider MEP(s).",
            "LMEP_Id is for Provider or CFM MEP(s).",
            "Could be up to seven levels in theory.",
            "Provider Up MEP Rx from partner and/or CFM Down MEP TX to partner"
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>|0x1000",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress DSCP PCP Remark"
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "There's suppposed to be a MEP or MIP here.",
            "But don't know what to do with this packet, so just forward it.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress DSCP PCP Remark"
            }
          ]
        }
      ]
    },
    {
      "name": "Egress DSCP PCP Remark",
      "doc": [
        "Used for optionally marking QoS fields in VLAN and IP headers.",
        "Marking based on final TRAFFIC_CLASS and COLOR values."
      ],
      "flow_mod_types": [
        {
          "name": "Remark PCP DSCP (IPv 4)",
          "priority": "2",
          "doc": [
            "Remark DSCP (IPv4), PCP, and/or DEI.",
            "Can be used to set S-Tag PCP and DEI for UNI-UNI interoperability.",
            "Ethertype required as prerequisite."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$TRAFFIC_CLASS",
              "value": "<traffic_class>",
              "match_type": "exact"
            },
            {
              "field": "$COLOR",
              "value": "<color>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Remark PCP DSCP (IPv6)",
          "priority": "2",
          "doc": [
            "Remark DSCP (IPv6), PCP, and/or DEI.",
            "Can be used to set S-Tag PCP and DEI for UNI-UNI interoperability.",
            "Ethertype required as prerequisite."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$TRAFFIC_CLASS",
              "value": "<traffic_class>",
              "match_type": "exact"
            },
            {
              "field": "$COLOR",
              "value": "<color>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<ip_dscp>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Remark PCP",
          "priority": "1",
          "doc": [
            "Remark VLAN PCP, and/or DEI.",
            "Can be used to set S-Tag PCP and DEI for UNI-UNI interoperability."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "$TRAFFIC_CLASS",
              "value": "<traffic_class>",
              "match_type": "exact"
            },
            {
              "field": "$COLOR",
              "value": "<color>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss",
          "priority": "0",
          "doc": [
            "Do not change QoS header field values.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress TPID"
            }
          ]
        }
      ]
    },
    {
      "name": "Egress TPID",
      "doc": [
        "Used to set the outermost TPID (VLAN tag Ethertype) on tagged packets."
      ],
      "flow_mod_types": [
        {
          "name": "S-Tag",
          "priority": "2",
          "doc": [
            "Make NNI port - set TPID to S-TAG (0x88a8).",
            "Last table in egress pipeline.",
            "Only applies to packets with a VLAN tag."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "COPY_FIELD",
                  "field": "VLAN_VID",
                  "value": "$PACKET_REGS(1)"
                },
                {
                  "action": "POP_VLAN"
                },
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x88a8"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_VID",
                  "value": "$PACKET_REGS(1)"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Table miss tagged",
          "priority": "1",
          "doc": [
            "Default is UNI port - set TPID to C-TAG (0x8100).",
            "Last table in egress pipeline.",
            "Only applies to packets with a VLAN tag.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [
            {
              "field": "VLAN_VID",
              "value": "0x1000",
              "match_type": "mask",
              "mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "COPY_FIELD",
                  "field": "VLAN_VID",
                  "value": "$PACKET_REGS(1)"
                },
                {
                  "action": "POP_VLAN"
                },
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                },
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_VID",
                  "value": "$PACKET_REGS(1)"
                }
              ]
            }
          ]
        },
        {
          "name": "Table miss untagged",
          "priority": "0",
          "doc": [
            "Default untagged - send out port.",
            "Fixed rule, cannot be modified or deleted by controller."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    }
  ],
  "group_entry_types": [
    {
      "name": "L2 Rewrite",
      "doc": [
        "Used to modify Ethernet header fields for bridged packets.",
        "Naming Convention : Type [31:28]:1, Id [27:0]:0xnnnnnn, :"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MAC_SRC",
                  "value": "<mac>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MAC_DST",
                  "value": "<mac>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_ID",
                  "value": "<vid>|0x1000"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Multicast",
      "doc": [
        "Used to specify L2 Multicast replication.",
        "VLAN id values must be consistent.",
        "Naming Convention : Type [31:28]:3, VLAN Id [27:16]:0xnnn, Id [15:0]:0xnnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Flood",
      "doc": [
        "Used to specify flooding in a VLAN.",
        "VLAN id values must be consistent.",
        "Recommended instead of FLOOD reserved port.",
        "Naming Convention : Type [31:28]:4, VLAN Id [27:16]:0xnnn, Id [15:0]:0xnnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L3 ECMP",
      "doc": [
        "Used to specify IP multipath.",
        "Naming Convention : Type [31:28]:7, Id [27:0]:0xnnnnnn, :"
      ],
      "group_type": "SELECT",
      "bucket_types": [
        {
          "name": "Multipath Destination",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Unicast>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Unicast",
      "doc": [
        "Used for Ethernet next hop configuration.",
        "ALLOW_IN_PORT=1 by default for this group.",
        "Naming Convention : Type [31:28]:2, Id [27:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC",
              "value": "<mac>"
            },
            {
              "action": "SET_FIELD",
              "field": "MAC_DST",
              "value": "<mac>"
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_ID",
              "value": "<vid>|0x1000"
            },
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Multicast",
      "doc": [
        "Used fo specify IP Replication.",
        "VLAN id values must be consistent",
        "Naming Convention : Type [31:28]:6, VLAN Id [27:16]:0xnnn, Id [15:0]:0xnnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Interface",
      "doc": [
        "Used for L3 multicast.",
        "ALLOW_IN_PORT=1 by default.",
        "VLAN Id must be consistent with interface group.",
        "Naming Convention : Type [31:28]:5, Id [27:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC",
              "value": "<mac>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MAC_DST",
                  "value": "<mac>"
                }
              ]
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_ID",
              "value": "<vid>|0x1000"
            },
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Flood over Unicast Tunnels",
      "doc": [
        "L2 Overlay Flood over Unicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:0, Index [9:0]:0xnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Flood over Multicast Tunnels",
      "doc": [
        "L2 Overlay Flood over Multicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:1, Index [9:0]:0xnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Multicast over Unicast Tunnels",
      "doc": [
        "L2 Overlay Multicast over Unicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:2, Index [9:0]:0xnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Multicast over Multicast Tunnels",
      "doc": [
        "L2 Overlay Multicast over Multicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:3, Index [9:0]:0xnnn"
      ],
      "group_type": "ALL",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Fast Failover",
      "doc": [
        "Working (1) or protection (0) path bucket. ",
        "Next Label depends on specifics of packet flow. ",
        "Watch OAM Protection Liveness Logical Port.",
        "Both buckets must chain to the same group entry type.",
        "Naming Convention: Type [31:28]:10, Sub-Type [27:24]:6, Index{23:0]:0xnnnnnn"
      ],
      "group_type": "FF",
      "bucket_types": [
        {
          "name": "Working(1)",
          "doc": [
            "watch : <lport_no>"
          ],
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        },
        {
          "name": "Protection(0) ",
          "doc": [
            "watch : <lport_no>"
          ],
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 VPN Label",
      "doc": [
        "VLAN id and L2 Addresses are set in MPLS Interface group",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:1, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "$PUSH_L2_HEADER"
            },
            {
              "zero_or_one": [
                {
                  "action": "PUSH_VLAN",
                  "ethertype": "0x8100"
                }
              ]
            },
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "$PUSH_CW"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_BOS",
              "value": "1"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L3 VPN Label",
      "doc": [
        "Used for L3 VPN tunnel initiation.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:2, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_BOS",
              "value": "1"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "$COPY_TTL_OUT"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Swap Label Group",
      "doc": [
        "Used for LSR.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:5, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_VPN_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Tunnel Label 1",
      "doc": [
        "Used for MPLS LSP.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:3, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "COPY_TTL_OUT"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Tunnel label 2",
      "doc": [
        "Used to push a third label for certain flows (e.g., ring label).",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:4, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_TUNNEL_TABLE",
                  "value": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "COPY_TTL_OUT"
                }
              ]
            },
            {
              "action": "GROUP",
              "group_id": "<MPLS Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS ECMP",
      "doc": [
        "Used for MPLS multipath in PE, LER, or LSR.",
        "Naming Convention : Type [31:28]:10, Sub-type:8, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "SELECT",
      "bucket_types": [
        {
          "name": "Multipath Destination",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Interface",
      "doc": [
        "Used to OUTPUT an MPLS encapsulated packet",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:0"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC",
              "value": "<mac>"
            },
            {
              "action": "SET_FIELD",
              "field": "MAC_DST",
              "value": "<mac>"
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_ID",
              "value": "<vid>|0x1000"
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Interface",
      "doc": [
        "Port VLAN filtering enabled, this VLAN allowed.",
        "Implementations can  use to configure egress port VLAN.",
        "VLAN cannot be changed after this group entry.",
        "Naming Convention : Type [31:28]:0, Vlan Id [27:16]:0xnnn, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "VlanTagging",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "POP_VLAN"
                }
              ]
            },
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            },
            {
              "action": "SET_FIELD",
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": 0
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Unfiltered Interface",
      "doc": [
        "Port has egress VLAN filtering disabled, any VLAN allowed.",
        "Allow Egress VLAN Translation to change outermost VLAN.",
        "Naming Convention : Type [31:28]:11, Vlan Id [27:16]:0x000, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "AllowAllVLANs",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            },
            {
              "action": "SET_FIELD",
              "field": "$ALLOW_VLAN_TRANSLATION",
              "value": 1
            }
          ]
        }
      ]
    }
  ],
  "meter_table": {
    "meter_types": [
      {
        "name": "Color Set Experimenter Meter Type",
        "doc": [
          "RFC Standard policer",
          "color is one of: green(0), yellow(1), red(2)",
          "color_aware is one of: Color Blind(0), Color Aware(1)",
          "mode is one of: TrTCM(1), SrTCM(2), Modified TrTCM(4)"
        ],
        "bands": [
          {
            "doc": [
              "color: <color>",
              "color_aware: <color-aware>",
              "mode: <mode>"
            ],
            "rate": "<meter_rate>",
            "burst": "<meter_burst>"
          }
        ]
      }
    ]
  }
}